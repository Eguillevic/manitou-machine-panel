<template>
  <NuxtLayout>
    <NuxtLoadingIndicator />
    <NuxtPage/>
  </NuxtLayout>
</template>

<script setup>
import * as localforage from "localforage";
const { $storage, $api } = useNuxtApp()

localforage.ready(async () => {
  let machines = await $storage.json.getItem('machines')
  if (!machines) machines = await $api.machine.getMachines({country: 'FR'})
  let attachments = await $storage.json.getItem('attachments')
  if (!attachments) attachments = await $api.machine.getAttachments({country: 'FR', unit: 'all', locale: 'fr-FR'})
  let innovations = await $storage.json.getItem('innovations')
  if (!innovations) innovations = await $api.machine.getInnovations({country: 'FR', locale: 'fr-FR'})
  let services = await $storage.json.getItem('services')
  if (!services) services = await $api.machine.getServices({country: 'FR', locale: 'fr-FR'})
  await $storage.json.setItem('machines', machines)
  await $storage.json.setItem('attachments', attachments)
  await $storage.json.setItem('innovations', innovations)
  await $storage.json.setItem('services', services)
  const logo = await $storage.images.getItem('logo')
  console.log(logo)

  await $storage.images.setItem('logo_svg', '~/assets/images/Manitou.svg')
  // const imageStorage = localforage.createInstance({
  //   name: "manitou",
  //   driver: localforage.INDEXEDDB,
  //   storeName: 'images',
  //   description: 'Images storage'
  // });
  //
  // imageStorage.setItem('logo',  {type: 'svg+xml', text: 'PHN2ZyB3aWR0aD0iNTIxIiBoZWlnaHQ9IjEwNCIgdmlld0JveD0iMCAwIDUyMSAxMDQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMC4xMzY3OTIgODkuODM4NUMwLjA0NjQ2OTcgODkuNzMzOSAtMC4wMTgwNDY0IDg5LjYwNTQgMC4wMDQ1MzQyNSA4OS40NDdMNC4yODUxNyA2Mi45NTY4QzYuMzIwNjUgNzUuMDQ3IDE1LjIzMDMgODQuNTQ2NCAyNy43MzY3IDg4LjA3MjRDMjkuMTA3NyA4OC40NTQ5IDMwLjY0OTYgODguNjQwMiAzMi4yMjcxIDg4LjY1NTFIMzkuOTQ2NEM0Mi4zODE5IDg4LjY1NTEgNDQuODE3NCA4OC40MjggNDcuMjIzOCA4OC4wMTg3QzY1LjA0NjMgODQuNTEwNSA4MC4xMDEyIDcwLjMyNTcgODIuNzg4MyA1My4yNjAyTDgyLjc4ODUgNTMuMjU5QzgyLjgxNzQgNTMuMDg2MSA4Mi44NDY0IDUyLjkxMzEgODIuODcyMSA1Mi43NDAyQzg1LjExMDggMzcuMDI4NCA3NS43MzAyIDIyLjc1OTkgNjEuMzA0NCAxNy43MTg4QzYxLjI2IDE3LjcwNDQgNjEuMjE1NyAxNy42OTAxIDYxLjE3MTMgMTcuNjc1N0M2MC41NDE4IDE3LjQ3MTggNTkuOTEzMiAxNy4yNjgxIDU5LjI1OTMgMTcuMTA2Mkg4OS43ODVDODkuOTM2NiAxNy4xMDYyIDkwLjA0MzEgMTcuMTY2IDkwLjE0NjMgMTcuMjM0N0M5MC4xNTI2IDE3LjIzODYgOTAuMTU0OCAxNy4yNDM5IDkwLjE1NjUgMTcuMjQ3OEM5MC4xNTc0IDE3LjI0OTkgOTAuMTU4MSAxNy4yNTE2IDkwLjE1OTIgMTcuMjUyN0M5MC4xNjY1IDE3LjI1OTQgOTAuMTY4MyAxNy4yNjYxIDkwLjE3MDEgMTcuMjcyOEM5MC4xNzA3IDE3LjI3NTEgOTAuMTcxMyAxNy4yNzczIDkwLjE3MjEgMTcuMjc5NUM5MC4yNjI0IDE3LjM3MjIgOTAuMjk3OSAxNy40OTc3IDkwLjI3ODYgMTcuNjM1MUw4NC40MDQ0IDUzLjk5ODNDODEuMjY1NyA3My45MjA0IDYxLjQ3NTQgODkuOTg0OSAzOS45MzM1IDg5Ljk4NDlIMzkuODg4M0gwLjQ5MTYzQzAuMzQwMDE4IDg5Ljk4NDkgMC4yMTc0MzcgODkuOTI4MSAwLjEzMDM0IDg5Ljg0MTRMMC4xMzY3OTIgODkuODM4NVpNOTMuMjkzMSA4Ny4xODE5SDExMS41MTRMMTE4LjkzNCAzOS4yMDc4TDExOS4zNjUgODcuMTgxOUgxNDAuNzczTDE1NS45MTcgNDAuMDEwMUwxNDguNjQgODcuMTgxOUgxNjkuNjkxTDE4MC41NjcgMTcuMTA2MkgxNDguNDcxTDEzNS40MjQgNTcuNjU4NkwxMzYuMSAxNy4xMTg2SDEwNC4xNjNMOTMuMjkzMSA4Ny4xODE5Wk02OS4wMzk1IDU5LjI2NDVDNjguNDQxNCA1OS40MTcgNjcuODIxMSA1OS4wNzYyIDY3LjY3NTUgNTguNTA4MUw2MS4zNTg5IDM0LjczMDlDNjEuMjEwMSAzNC4xNjI5IDYwLjU5MyAzMy44MTMxIDYwLjAwMTMgMzMuOTU2Nkw1Ni44MzAzIDM0LjY2MjJDNTYuMjE5NSAzNC43OTk3IDU1Ljg1NTYgMzUuMzg1NyA1Ni4wMTM4IDM1Ljk1MzdMNjAuOTY2NSA1NC42Mjc1QzYwLjgxNzYgNTQuNjcxNSA2MC4xODgzIDU0LjgwNTIgNTkuNTQ3MiA1NC45NDE0TDU5LjU0NjEgNTQuOTQxNkw1OS41NDU0IDU0Ljk0MThMNTkuNTQ1IDU0Ljk0MThMNTkuNTQ1IDU0Ljk0MThMNTkuNTQ0OSA1NC45NDE5TDU5LjU0NDYgNTQuOTQxOUw1OS41NDI4IDU0Ljk0MjNMNTkuNTQyMSA1NC45NDI1QzU4Ljg3NjggNTUuMDgzOCA1OC4yMDAyIDU1LjIyNzYgNTguMDM2IDU1LjI3NjNDNTYuNzQ0OCA1MC42MzkyIDUzLjI5MjIgMzguMjE5OSA1My4yOTIyIDM4LjIxOTlDNTIuODkzNSAzNi43NzU5IDUxLjUxMDUgMzUuNzc0MyA0OS45NDA5IDM1Ljc3NDNINDAuNjA1MkMzOS4zMjAzIDM1Ljc3NDMgMzguMTQ2MiAzNi40MzUxIDM3LjU0MTggMzcuNTAyNEMzNy41NDE4IDM3LjUwMjQgMzIuNDY1NyA0Ni40MjY3IDMwLjk3NTIgNDkuMDQyN0gxNS45NzQ4QzE0Ljc0MzcgNDkuMDQyNyAxMy41OTE4IDQ5LjY3MDUgMTIuOTcxNSA1MC42ODQxTDkuNDk5OSA1Ni4zNTU1QzkuMTg2NiA1Ni44NjA4IDkuMDI4MzcgNTcuNDI4OSA5LjAyODM3IDU3Ljk5OTlDOS4wMjgzNyA1OC4xNjQzIDkuMDQ0MTkgNTguMzI4OCA5LjA2OTUxIDU4LjQ5MzJMOS43NTk0IDYyLjgxMDNDOS44NjA2NyA2My40NjUxIDEwLjE2NzYgNjQuMDQ4MSAxMC42MjAyIDY0LjUxNDVDMTAuNDU1NiA2NC45OTg4IDEwLjM0MTcgNjUuNTA3MSAxMC4yODc5IDY2LjAyNDNDMTAuMDk4IDY3LjkxMzggMTAuNzE4MyA2OS43MDc2IDEyLjAyNTMgNzEuMDY1QzEzLjMyNiA3Mi40MTkzIDE1LjE0NTYgNzMuMTY2NyAxNy4xNDU3IDczLjE2NjdDMjEuMTE3MyA3My4xNjY3IDI0LjUyNTYgNzAuMjMwOCAyNC44OTkgNjYuNDg3N0MyNC45MTggNjYuMjYzNSAyNC45Mjc1IDY2LjAzNjMgMjQuOTI3NSA2NS44MThDMjQuOTI3NSA2NS43NDMzIDI0LjkyNzUgNjUuNjcxNSAyNC45MjQ0IDY1LjU5OThIMzcuNjU4OUMzOC4wMTk2IDY3LjI0MTEgMzguODI5OCA2OC43NTM5IDQwLjAzODcgNzAuMDEyNkM0MS45NTk2IDcyLjAwOTcgNDQuNjQzMiA3My4xMDY5IDQ3LjU4NjQgNzMuMTA2OUM1My40OTE2IDczLjEwNjkgNTguNTQ4NyA2OC43NDc5IDU5LjEwNTcgNjMuMTc4MUM1OS4xNSA2Mi43MjA3IDU5LjE2ODkgNjIuMjY2MiA1OS4xNDY4IDYxLjgxNzhMNjIuNjY1OSA2MS4wMDc1TDYzLjYzNzQgNjQuNjc1OUM2My43ODkzIDY1LjIzOCA2NC40MDAxIDY1LjU4MTggNjUuMDAxNCA2NS40MzUzTDc1LjcyMzIgNjIuNjY5OEM3Ni4zMTgxIDYyLjUyMzMgNzYuODk0MSA2MS44ODA1IDc3LjAwMTcgNjEuMjQ2N0w3OC4yMjY0IDU3LjkxOTJDNzguMzQwNCA1Ny4yODUzIDc3Ljk0MTYgNTYuODgxNyA3Ny4zNDM1IDU3LjAzNDJMNjkuMDM5NSA1OS4yNjQ1Wk00Ny41ODY0IDY2LjcyOTlDNDYuNTY3MyA2Ni43Mjk5IDQ1LjY1OTEgNjYuMzcxMSA0NS4wMzU3IDY1LjcyODNDNDQuNDA1OSA2NS4wNjQ2IDQ0LjExMTYgNjQuMTYxNyA0NC4yMDY1IDYzLjE3ODFDNDQuNDM3NSA2MC45MjY4IDQ2LjYzMDYgNTkuMDI1NCA0OS4wMDczIDU5LjAyNTRDNTAuMDI2MyA1OS4wMjU0IDUwLjkzNDYgNTkuMzg3MSA1MS41NjExIDYwLjAzNTlDNTIuMTk0MSA2MC42ODc2IDUyLjQ4ODQgNjEuNTk2NSA1Mi4zOTAzIDYyLjU4MDFDNTIuMTYyNCA2NC44Mjg0IDQ5Ljk2NjIgNjYuNzI5OSA0Ny41ODY0IDY2LjcyOTlaTTE2LjE4NjggNTkuMDM0M0wxNi4xNzk1IDU4Ljk5NzNMMTYuMTc5NSA1OC45OTcyTDE2LjE3OTQgNTguOTk3MkMxNi4xNTAxIDU4Ljg0ODYgMTYuMTM3OSA1OC43ODcxIDE2LjEyMDMgNTguNjQ4N0MxNi40MTM4IDU4LjE2NzYgMTYuNzEyOSA1Ny42Nzk0IDE3LjA0ODQgNTcuMTMxN0wxNy4wNSA1Ny4xMjkyTDE3LjA1MzYgNTcuMTIzM0wxNy4wNTY5IDU3LjExNzlMMTcuMDYxNyA1Ny4xMUMxNy4zMzc3IDU2LjY1OTUgMTcuNjM4NSA1Ni4xNjg1IDE3Ljk4MTEgNTUuNjA4MUgzMy4wNTQzQzM0LjMzNiA1NS42MDgxIDM1LjUxMzMgNTQuOTQ0NCAzNi4xMjA5IDUzLjg4MDFDMzYuMTIwOSA1My44ODAxIDQxLjE5MDYgNDQuOTUyOCA0Mi42ODQzIDQyLjMzNjhINDcuMjU3MkM0Ny41MTE5IDQzLjI1NzIgNDcuOTM1NSA0NC43ODEzIDQ4LjQzMDkgNDYuNTY0QzQ4Ljk1NzMgNDguNDU4MiA0OS41NjQ4IDUwLjY0NDIgNTAuMTM3MSA1Mi43MDgxQzQ5Ljc2MzYgNTIuNjY2MiA0OS4zODcgNTIuNjQ4MyA0OS4wMDczIDUyLjY0ODNDNDQuNDQwNyA1Mi42NDgzIDQwLjM2NzggNTUuMjYxMyAzOC41MTAyIDU5LjAzNDNIMTYuMTg2OFpNMTcuMTQ1NyA2OC4yODc1QzE2LjQ3MTYgNjguMjg3NSAxNi4wNjY1IDY4LjAxODQgMTUuODQ4MiA2Ny43ODUyQzE1LjUxOSA2Ny40NTA0IDE1LjM3NjYgNjYuOTkgMTUuNDMwNCA2Ni40ODc3QzE1LjU1MzkgNjUuMjYxOSAxNi43NTAxIDY0LjIyMTUgMTguMDQxMyA2NC4yMjE1QzE4LjcxNTMgNjQuMjIxNSAxOS4xMjA0IDY0LjQ5OTUgMTkuMzM4OCA2NC43MzI3QzE5LjY1ODQgNjUuMDU4NiAxOS44MDQgNjUuNTE2IDE5Ljc2MjggNjYuMDI0M0MxOS42Mzk0IDY3LjI1MDEgMTguNDQzMiA2OC4yODc1IDE3LjE0NTcgNjguMjg3NVpNMjA2LjQyOSA1OC41MDg3SDIxNS43MDJWMzMuNzQ3NEwyMDYuNDI5IDU4LjUwODdaTTIzNC42MzMgMTcuMTA2MkwyNDAuNzU3IDg3LjE2OTVIMjE2LjkyN1Y3Ni4wOTdIMjAxLjAzMkwxOTYuNzI0IDg3LjE4MTlIMTc0LjU0OEwyMDUuMDAzIDE3LjEwNjJIMjM0LjYzM1pNMjQ2Ljc3NSA4Ny4xODE5SDI2NS4wNDdMMjcxLjUzOCA0NS4zNTEyTDI3Ny43NjcgODcuMTY2NEgzMDUuMTA4TDMxNS45OTMgMTcuMTA2MkgyOTcuMjcyTDI5MC44ODYgNTguMzA0M0wyODUuMjQgMTcuMTA2MkgyNTcuNjczTDI0Ni43NzUgODcuMTgxOVpNMzM0LjcxNiA4Ny4xODE5SDMwOS45NzRMMzIxLjM0MiAxNy4xMDYySDM0Ni4wODdMMzM0LjcxNiA4Ny4xODE5Wk01MDkuOTUgNjYuMTExNEw1MDkuOTQ5IDY2LjExODlDNTA5LjkwNiA2Ni41NzI4IDUwNy45NTQgODcuMTgxOSA0NzcuODUgODcuMTgxOUM0NTIuMTI0IDg3LjE4MTkgNDUzLjk5NiA3MS45OTk1IDQ1NC44MiA2Ni4wMzIzTDQ2Mi41MzkgMTcuMTE4NEM0NjIuNTM5IDE3LjExODQgNDgzLjExNSAxNy4xMDYyIDQ4NS44MTUgMTcuMTA2Mkw0NzguNTA0IDYzLjI3NjlMNDc4LjUwMiA2My4yODk1QzQ3OC4yNDQgNjQuOTM5OSA0NzcuNjE0IDY4Ljk3MzMgNDgxLjk3IDY4Ljk3MzNDNDg2LjMzMSA2OC45NzMzIDQ4Ni45NzUgNjQuOTE5MiA0ODcuMjMyIDYzLjI3NjlMNDk0LjQ1OSAxNy4xMDYyQzQ5NS45MDYgMTcuMTA2MiA1MTcuNjI2IDE3LjEyMTQgNTE3LjYyNiAxNy4xMjE0TDUwOS45NSA2Ni4xMTE0Wk00MjEuOTgyIDY5LjAxODdDNDI2LjMzMyA2OS4wMTg3IDQyNi45NzIgNjQuOTYyNiA0MjcuMjI4IDYzLjMyMTlMNDMwLjg1NiA0MC40MDM4QzQzMS4xODkgMzguMjk4MiA0MzEuNzU1IDM0LjcxIDQyNy40MSAzNC43MUM0MjMuMDYyIDM0LjcxIDQyMi40OTIgMzguMjg4IDQyMi4xNTYgNDAuMzk0OEw0MjIuMTU0IDQwLjQwMzhMNDE4LjUzMiA2My4zMjE5QzQxOC4yNzMgNjQuOTYyNiA0MTcuNjM0IDY5LjAxODcgNDIxLjk4MiA2OS4wMTg3Wk0zNTEuOTU4IDE3LjE0ODRINDI0LjY3N0M0MjUuOTc4IDE3LjE0ODQgNDI3LjIyOCAxNy4xMzcxIDQyOC40MzIgMTcuMTI2MkM0MzYuMzEzIDE3LjA1NDYgNDQyLjE4OCAxNy4wMDEyIDQ0Ny4xNjEgMjAuMjc0OUM0NTYuNDQ4IDI2LjQ0ODggNDU0LjE4NSAzNy42MjY4IDQ1NC4xODUgMzcuNjI2OEw0NDkuNzA5IDY1Ljg3NzFDNDQ5LjcwOSA2NS44NzcxIDQ0Ny42NDQgODcuMTgxOSA0MTguMTQ1IDg3LjE4MTlDMzkwLjU4NyA4Ny4xODE5IDM5NS41NjIgNjIuOTgxNiAzOTUuNTYyIDYyLjk4MTZMNDAwLjAxNSAzNC43MTkxSDM4NC43NDNMMzc2LjcyMiA4Ni4xMjc2SDM1My4zODFMMzYxLjQyOCAzNC42Njc0SDM0OS4wOTdMMzUxLjk1OCAxNy4xNDg0Wk0xMy4zODI3IDE3LjEwNjJDMTMuMDcyMyAxNy4xMDYyIDEyLjc4NzEgMTcuMzU1OCAxMi43NDMyIDE3LjY2MTVMOS4wMjgzNyA0Mi4zMzM1QzE0LjY5NjIgMzAuMDI3MSAyNi4wNDQzIDIwLjQ2MjggMzkuMTIyOSAxNy4xMDYySDEzLjM4MjdaIiBmaWxsPSIjRUIxMjEyIi8+Cjwvc3ZnPgo'})
  // const emailStorage = localforage.createInstance({
  //   name: "manitou",
  //   driver: localforage.INDEXEDDB,
  //   storeName: 'emails',
  //   description: 'Emails storage'
  // });
  //
  // emailStorage.setItem('test', 'test.test@test.test')
}).catch((e) => {
  console.log('Le module de stockage à rencontré une erreur.', e)
});
</script>

<style>
.page-enter-active,
.page-leave-active {
  transition: all 75ms;
}

.page-enter-from,
.page-leave-to {
  opacity: 0;
}
</style>

